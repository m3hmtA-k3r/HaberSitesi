@model HaberDetayViewModel

@{
    ViewData["Title"] = Model.Haber.Baslik + " - MASKER";
    ViewData["Description"] = Model.Haber.Icerik.Length > 160 ? Model.Haber.Icerik.Substring(0, 160) + "..." : Model.Haber.Icerik;
    ViewData["Keywords"] = Model.Haber.Kategori + ", haber, " + Model.Haber.Yazar;
    ViewData["OgType"] = "article";
    ViewData["OgImage"] = conf.GetSection("Ayarlar")["StaticFilesUrl"] + Model.Haber.Resim;
}

<style>
    .news-detail-container { padding: 3rem 0; }
    .news-detail-card { background: #fff; border-radius: 20px; overflow: hidden; box-shadow: 0 4px 20px rgba(0,0,0,0.1); margin-bottom: 2rem; }
    .news-detail-header { position: relative; height: 500px; overflow: hidden; }
    .news-detail-header img { width: 100%; height: 100%; object-fit: cover; }
    .news-detail-overlay { position: absolute; bottom: 0; left: 0; right: 0; background: linear-gradient(to top, rgba(0,0,0,0.9) 0%, rgba(0,0,0,0.3) 50%, transparent 100%); padding: 3rem 2rem; }
    .news-detail-category { display: inline-block; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: #fff; padding: 0.5rem 1rem; border-radius: 20px; font-size: 0.85rem; font-weight: 600; text-transform: uppercase; margin-bottom: 1rem; text-decoration: none; }
    .news-detail-title { color: #fff; font-size: 2.5rem; font-weight: 700; line-height: 1.3; margin: 0; text-shadow: 2px 2px 8px rgba(0,0,0,0.5); }

    .news-detail-body { padding: 2.5rem; }
    .news-detail-meta { display: flex; gap: 2rem; padding: 1.5rem 2.5rem; background: #f7fafc; border-bottom: 1px solid #e2e8f0; flex-wrap: wrap; }
    .meta-item { display: flex; align-items: center; gap: 0.5rem; color: #4a5568; font-size: 0.95rem; }
    .meta-item i { color: #667eea; }
    .meta-author { display: flex; align-items: center; gap: 0.8rem; }
    .meta-author-img { width: 40px; height: 40px; border-radius: 50%; border: 2px solid #667eea; }

    .news-content { font-size: 1.1rem; line-height: 1.8; color: #2d3748; margin-bottom: 2rem; }
    .news-content p { margin-bottom: 1.5rem; }

    .video-section { margin: 2rem 0; }
    .video-title { font-size: 1.5rem; font-weight: 700; color: #2d3748; margin-bottom: 1.5rem; display: flex; align-items: center; gap: 0.5rem; }
    .video-title i { color: #667eea; }
    .video-container { position: relative; border-radius: 15px; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
    .video-container video { width: 100%; border-radius: 15px; }

    .comments-section { background: #fff; border-radius: 20px; padding: 2.5rem; box-shadow: 0 4px 20px rgba(0,0,0,0.1); margin-bottom: 2rem; }
    .comments-header { font-size: 1.8rem; font-weight: 700; color: #2d3748; margin-bottom: 2rem; display: flex; align-items: center; gap: 0.8rem; }
    .comments-header i { color: #667eea; }
    .comment-count { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: #fff; padding: 0.3rem 0.8rem; border-radius: 20px; font-size: 1rem; }

    .comment-item { padding: 1.5rem; margin-bottom: 1.5rem; background: #f7fafc; border-radius: 15px; border-left: 4px solid #667eea; transition: all 0.3s; }
    .comment-item:hover { background: #edf2f7; transform: translateX(5px); }
    .comment-header { display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem; }
    .comment-avatar { width: 50px; height: 50px; border-radius: 50%; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); display: flex; align-items: center; justify-content: center; color: #fff; font-weight: 700; font-size: 1.2rem; }
    .comment-author { font-weight: 700; color: #2d3748; font-size: 1.1rem; }
    .comment-date { color: #a0aec0; font-size: 0.85rem; margin-left: auto; }
    .comment-title { font-size: 1.1rem; font-weight: 600; color: #4a5568; margin-bottom: 0.5rem; }
    .comment-text { color: #718096; line-height: 1.6; font-size: 0.95rem; }

    .comment-form { background: #fff; border-radius: 20px; padding: 2.5rem; box-shadow: 0 4px 20px rgba(0,0,0,0.1); }
    .form-header { font-size: 1.8rem; font-weight: 700; color: #2d3748; margin-bottom: 2rem; display: flex; align-items: center; gap: 0.8rem; }
    .form-header i { color: #667eea; }
    .form-group label { font-weight: 600; color: #4a5568; margin-bottom: 0.5rem; display: block; }
    .form-control { border: 2px solid #e2e8f0; border-radius: 10px; padding: 0.8rem 1rem; font-size: 0.95rem; transition: all 0.3s; }
    .form-control:focus { border-color: #667eea; box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1); }
    .btn-submit { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border: none; color: #fff; padding: 0.8rem 2rem; border-radius: 10px; font-weight: 600; font-size: 1rem; transition: all 0.3s; }
    .btn-submit:hover { transform: translateY(-2px); box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4); color: #fff; }

    .sidebar-card { background: #fff; border-radius: 15px; padding: 1.5rem; box-shadow: 0 4px 15px rgba(0,0,0,0.08); margin-bottom: 2rem; }
    .sidebar-header { font-size: 1.5rem; font-weight: 700; color: #2d3748; margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid #e2e8f0; }
    .category-list { list-style: none; padding: 0; margin: 0; }
    .category-item { margin-bottom: 0.5rem; }
    .category-link { display: block; padding: 0.8rem 1rem; border-radius: 10px; color: #4a5568; text-decoration: none; transition: all 0.3s; font-weight: 500; }
    .category-link:hover { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: #fff; transform: translateX(5px); }

    .related-news { background: #fff; border-radius: 15px; padding: 1.5rem; box-shadow: 0 4px 15px rgba(0,0,0,0.08); }
    .related-header { font-size: 1.5rem; font-weight: 700; color: #2d3748; margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid #e2e8f0; }
    .related-item { display: flex; gap: 1rem; padding: 1rem 0; border-bottom: 1px solid #e2e8f0; transition: all 0.3s; }
    .related-item:last-child { border-bottom: none; }
    .related-item:hover { background: #f7fafc; padding-left: 0.5rem; border-radius: 10px; }
    .related-item-img { width: 80px; height: 60px; border-radius: 8px; object-fit: cover; flex-shrink: 0; }
    .related-item-content { flex: 1; }
    .related-item-title { font-size: 0.95rem; font-weight: 600; color: #2d3748; line-height: 1.4; margin-bottom: 0.3rem; text-decoration: none; display: block; }
    .related-item-title:hover { color: #667eea; }
    .related-item-date { font-size: 0.8rem; color: #a0aec0; }

    @@media (max-width: 768px) {
        .news-detail-header { height: 350px; }
        .news-detail-title { font-size: 1.75rem; }
        .news-detail-body, .comments-section, .comment-form { padding: 1.5rem; }
        .news-detail-meta { flex-direction: column; gap: 1rem; }
    }
</style>

<div class="news-detail-container">
    <div class="container">
        <div class="row">
            <!-- Main Content -->
            <div class="col-lg-8">
                <!-- News Detail -->
                <div class="news-detail-card">
                    <div class="news-detail-header">
                        <img src="@Url.Content(conf.GetSection("Ayarlar")["StaticFilesUrl"] + Model.Haber.Resim)" alt="@Model.Haber.Baslik" loading="lazy">
                        <div class="news-detail-overlay">
                            <a href="/Haberler/Index/@Model.Haber.KategoriId" class="news-detail-category">@Model.Haber.Kategori</a>
                            <h1 class="news-detail-title">@Model.Haber.Baslik</h1>
                        </div>
                    </div>

                    <div class="news-detail-meta">
                        <div class="meta-author">
                            <a href="/Yazar/Profil/@Model.Haber.YazarId" style="display: flex; align-items: center; gap: 0.8rem; text-decoration: none; color: inherit;">
                                <img src="@Url.Content(conf.GetSection("Ayarlar")["StaticFilesUrl"] + Model.Haber.YazarResim)" alt="@Model.Haber.Yazar" class="meta-author-img" loading="lazy">
                                <span class="font-weight-bold">@Model.Haber.Yazar</span>
                            </a>
                        </div>
                        <div class="meta-item">
                            <i class="far fa-calendar-alt"></i>
                            <span>@Model.Haber.EklenmeTarihi</span>
                        </div>
                        <div class="meta-item">
                            <i class="far fa-eye"></i>
                            <span>@Model.Haber.GosterimSayisi görüntülenme</span>
                        </div>
                        <div class="meta-item">
                            <i class="far fa-comment"></i>
                            <span>@Model.Yorumlar.Count() yorum</span>
                        </div>
                    </div>

                    <div class="news-detail-body">
                        <div class="news-content">
                            @Model.Haber.Icerik
                        </div>

                        @if (!string.IsNullOrEmpty(Model.Haber.Video))
                        {
                            <div class="video-section">
                                <h3 class="video-title">
                                    <i class="fas fa-play-circle"></i>
                                    Haber Videosu
                                </h3>
                                <div class="video-container">
                                    <video controls controlsList="nodownload">
                                        <source src="@Url.Content(conf.GetSection("Ayarlar")["StaticFilesUrl"] + Model.Haber.Video)" type="video/mp4" />
                                        Tarayıcınız video oynatmayı desteklemiyor.
                                    </video>
                                </div>
                            </div>
                        }
                    </div>
                </div>

                <!-- Comments Section -->
                <div class="comments-section">
                    <h3 class="comments-header">
                        <i class="fas fa-comments"></i>
                        Yorumlar
                        <span class="comment-count">@Model.Yorumlar.Count()</span>
                    </h3>

                    @if (Model.Yorumlar.Any())
                    {
                        @foreach (var item in Model.Yorumlar)
                        {
                            <div class="comment-item">
                                <div class="comment-header">
                                    <div class="comment-avatar">@item.Ad.Substring(0, 1)@item.Soyad.Substring(0, 1)</div>
                                    <div>
                                        <div class="comment-author">@item.Ad @item.Soyad</div>
                                        <div class="comment-date">
                                            <i class="far fa-clock"></i>
                                            @item.EklenmeTarihi.ToString("dd MMMM yyyy HH:mm")
                                        </div>
                                    </div>
                                </div>
                                <h5 class="comment-title">@item.Baslik</h5>
                                <p class="comment-text">@item.Icerik</p>
                            </div>
                        }
                    }
                    else
                    {
                        <div class="text-center py-4">
                            <i class="far fa-comment-slash fa-3x text-muted mb-3"></i>
                            <p class="text-muted">Henüz yorum yapılmamış. İlk yorumu siz yapın!</p>
                        </div>
                    }
                </div>

                <!-- Comment Form -->
                <div class="comment-form">
                    <h3 class="form-header">
                        <i class="fas fa-pen"></i>
                        Yorum Yapın
                    </h3>

                    @using (Html.BeginForm("YorumYap", "Haberler", FormMethod.Post))
                    {
                        @Html.AntiForgeryToken()
                        <input type="hidden" value="@Model.Haber.Id" name="HaberId" />

                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="Ad">Ad *</label>
                                    <input type="text" class="form-control" name="Ad" id="Ad" required placeholder="Adınızı girin">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="Soyad">Soyad *</label>
                                    <input type="text" class="form-control" name="Soyad" id="Soyad" required placeholder="Soyadınızı girin">
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="Baslik">Başlık *</label>
                                    <input type="text" class="form-control" name="Baslik" id="Baslik" required placeholder="Yorum başlığı">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="Eposta">E-posta *</label>
                                    <input type="email" class="form-control" name="Eposta" id="Eposta" required placeholder="ornek@email.com">
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="Icerik">Yorumunuz *</label>
                            <textarea id="Icerik" name="Icerik" rows="5" class="form-control" required placeholder="Yorumunuzu buraya yazın..."></textarea>
                        </div>

                        <div class="form-group mb-0">
                            <button type="submit" class="btn btn-submit">
                                <i class="fas fa-paper-plane mr-2"></i>
                                Yorumu Gönder
                            </button>
                        </div>
                    }
                </div>
            </div>

            <!-- Sidebar -->
            <div class="col-lg-4">
                <!-- Categories -->
                <div class="sidebar-card">
                    <h3 class="sidebar-header">Kategoriler</h3>
                    <ul class="category-list">
                        @foreach (var item in Model.Kategoriler)
                        {
                            <li class="category-item">
                                <a href="/Haberler?kategoriId=@item.Id" class="category-link">
                                    <i class="fas fa-folder mr-2"></i>
                                    @item.Aciklama
                                </a>
                            </li>
                        }
                    </ul>
                </div>

                <!-- Related News -->
                @if (Model.IlgiliHaberler.Any())
                {
                    <div class="related-news">
                        <h3 class="related-header">
                            <i class="fas fa-newspaper mr-2" style="color: #667eea;"></i>Ilgili Haberler
                        </h3>
                        @foreach (var haber in Model.IlgiliHaberler)
                        {
                            <div class="related-item">
                                <img src="@Url.Content(conf.GetSection("Ayarlar")["StaticFilesUrl"] + haber.Resim)" alt="@haber.Baslik" class="related-item-img" loading="lazy">
                                <div class="related-item-content">
                                    <a href="/Haberler/Detay/@haber.Id" class="related-item-title">
                                        @(haber.Baslik.Length > 50 ? haber.Baslik.Substring(0, 50) + "..." : haber.Baslik)
                                    </a>
                                    <span class="related-item-date">
                                        <i class="far fa-clock mr-1"></i>@haber.EklenmeTarihi.ToString("dd MMM yyyy")
                                    </span>
                                </div>
                            </div>
                        }
                    </div>
                }
            </div>
        </div>
    </div>
</div>