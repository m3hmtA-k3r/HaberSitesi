@using AdminUI.Models
@model MenuViewModel

<style>
    .form-container { max-width: 700px; margin: 0 auto; }
    .page-header { margin-bottom: 2rem; }
    .page-header h3 { font-weight: 700; color: #2d3748; margin-bottom: 0.5rem; }
    .page-header p { color: #718096; margin-bottom: 0; }
    .form-card { border: none; border-radius: 12px; box-shadow: 0 2px 12px rgba(0,0,0,0.08); overflow: hidden; }
    .form-card-header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: #fff; padding: 1.5rem; border: none; }
    .form-card-header h5 { margin: 0; font-weight: 600; display: flex; align-items: center; gap: 0.75rem; }
    .form-card-header .header-icon { width: 40px; height: 40px; border-radius: 8px; background: rgba(255,255,255,0.2); display: flex; align-items: center; justify-content: center; font-size: 1.2rem; }
    .form-card-body { padding: 2rem; }
    .form-section { margin-bottom: 1.5rem; }
    .form-section-title { font-size: 0.95rem; font-weight: 600; color: #2d3748; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 2px solid #e2e8f0; display: flex; align-items: center; gap: 0.5rem; }
    .form-section-title i { color: #667eea; }
    .form-label { font-weight: 600; color: #4a5568; margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem; }
    .form-label i { color: #a0aec0; font-size: 0.9rem; }
    .form-control, .form-select { border: 2px solid #e2e8f0; border-radius: 8px; padding: 0.65rem 0.95rem; transition: all 0.2s ease; }
    .form-control:focus, .form-select:focus { border-color: #667eea; box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1); }
    .form-control::placeholder { color: #cbd5e0; }
    .form-check-input { width: 3rem; height: 1.5rem; cursor: pointer; border: 2px solid #e2e8f0; }
    .form-check-input:checked { background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%); border-color: #11998e; }
    .status-label { display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem; background: #f7fafc; border-radius: 8px; border: 2px solid #e2e8f0; }
    .status-label .status-text { font-weight: 600; color: #4a5568; }
    .form-actions { display: flex; gap: 1rem; padding-top: 1.5rem; border-top: 2px solid #e2e8f0; margin-top: 1.5rem; }
    .btn-submit { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border: none; color: #fff; padding: 0.75rem 2rem; border-radius: 8px; font-weight: 600; transition: all 0.2s ease; display: inline-flex; align-items: center; gap: 0.5rem; }
    .btn-submit:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4); color: #fff; }
    .btn-cancel { background: #fff; border: 2px solid #e2e8f0; color: #4a5568; padding: 0.75rem 2rem; border-radius: 8px; font-weight: 600; transition: all 0.2s ease; display: inline-flex; align-items: center; gap: 0.5rem; }
    .btn-cancel:hover { background: #f7fafc; border-color: #cbd5e0; color: #2d3748; }
    .form-help { font-size: 0.85rem; color: #a0aec0; margin-top: 0.25rem; display: flex; align-items: center; gap: 0.25rem; }
    .form-help i { font-size: 0.75rem; }
    .role-checkbox { display: flex; flex-wrap: wrap; gap: 0.5rem; }
    .role-checkbox label { display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem 1rem; background: #f7fafc; border: 2px solid #e2e8f0; border-radius: 8px; cursor: pointer; transition: all 0.2s ease; }
    .role-checkbox label:hover { border-color: #667eea; }
    .role-checkbox input:checked + label { background: #667eea; color: #fff; border-color: #667eea; }
    .role-checkbox input { display: none; }
</style>

<div class="container-fluid">
    <div class="form-container">
        <div class="page-header">
            <h3><i class="fas fa-edit text-primary me-2"></i>Menü Düzenle</h3>
            <p>Menü bilgilerini güncelleyin</p>
        </div>
        <div class="card form-card">
            <div class="form-card-header">
                <h5><span class="header-icon"><i class="fas fa-bars"></i></span>Menü Bilgileri</h5>
            </div>
            <div class="card-body form-card-body">
                @using (Html.BeginForm("MenuGuncelle", "MenuYonetim", FormMethod.Post))
                {
                    @Html.HiddenFor(x => x.Id)

                    <div class="form-section">
                        <div class="form-section-title"><i class="fas fa-info-circle"></i>Temel Bilgiler</div>
                        <div class="row">
                            <div class="col-md-8 mb-4">
                                <label class="form-label"><i class="fas fa-heading"></i>Menü Adı</label>
                                @Html.TextBoxFor(x => x.Adi, new { placeholder = "Örn: Haber Modülü", @class = "form-control", required = "required" })
                                <small class="form-help"><i class="fas fa-info-circle"></i>Sidebar'da görünecek menü başlığı</small>
                            </div>
                            <div class="col-md-4 mb-4">
                                <label class="form-label"><i class="fas fa-sort-numeric-down"></i>Sıra</label>
                                @Html.TextBoxFor(x => x.Sira, new { type = "number", @class = "form-control", min = "0" })
                                <small class="form-help"><i class="fas fa-info-circle"></i>Görünüm sırası</small>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-4">
                                <label class="form-label"><i class="fas fa-icons"></i>İkon</label>
                                @Html.TextBoxFor(x => x.Ikon, new { placeholder = "Örn: fas fa-newspaper", @class = "form-control" })
                                <small class="form-help"><i class="fas fa-info-circle"></i>FontAwesome ikon class'ı</small>
                            </div>
                            <div class="col-md-6 mb-4">
                                <label class="form-label"><i class="fas fa-code"></i>Collapse ID</label>
                                @Html.TextBoxFor(x => x.CollapseId, new { placeholder = "Otomatik oluşturulur", @class = "form-control" })
                                <small class="form-help"><i class="fas fa-info-circle"></i>Bootstrap collapse için benzersiz ID</small>
                            </div>
                        </div>
                    </div>

                    <div class="form-section">
                        <div class="form-section-title"><i class="fas fa-user-shield"></i>Rol Erişimi</div>
                        <div class="role-checkbox">
                            @if (Model.Roller != null)
                            {
                                @foreach (var rol in Model.Roller)
                                {
                                    var isChecked = Model.RolIdler?.Contains(int.Parse(rol.Value)) ?? false;
                                    <div>
                                        <input type="checkbox" name="RolIdler" value="@rol.Value" id="rol_@rol.Value" @(isChecked ? "checked" : "")>
                                        <label for="rol_@rol.Value"><i class="fas fa-user-tag"></i> @rol.Text</label>
                                    </div>
                                }
                            }
                        </div>
                        <small class="form-help mt-2"><i class="fas fa-info-circle"></i>Bu menüyü görebilecek roller</small>
                    </div>

                    <div class="form-section">
                        <div class="form-section-title"><i class="fas fa-toggle-on"></i>Durum</div>
                        <div class="status-label">
                            @Html.CheckBoxFor(x => x.AktifMi, new { @class = "form-check-input", id = "statusSwitch" })
                            <div>
                                <div class="status-text" id="statusText">@(Model.AktifMi ? "Aktif" : "Pasif")</div>
                                <small class="form-help" style="margin-top: 0;"><i class="fas fa-info-circle"></i><span id="statusHelp">@(Model.AktifMi ? "Menü sidebar'da görünecek" : "Menü gizli kalacak")</span></small>
                            </div>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn btn-submit"><i class="fas fa-save"></i>Değişiklikleri Kaydet</button>
                        <a href="/MenuYonetim" class="btn btn-cancel"><i class="fas fa-times"></i>İptal</a>
                    </div>
                }
            </div>
        </div>
    </div>
</div>

<script>
    document.getElementById('statusSwitch')?.addEventListener('change', function() {
        const statusText = document.getElementById('statusText');
        const statusHelp = document.getElementById('statusHelp');
        if (this.checked) { statusText.textContent = 'Aktif'; statusHelp.textContent = 'Menü sidebar\'da görünecek'; }
        else { statusText.textContent = 'Pasif'; statusHelp.textContent = 'Menü gizli kalacak'; }
    });
</script>
