<!DOCTYPE html>
<html lang="tr">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>MASKER BO | Backoffice Yönetim Paneli</title>
	<link href="/assets/vendor/fontawesome/css/fontawesome.min.css" rel="stylesheet">
	<link href="/assets/vendor/fontawesome/css/solid.min.css" rel="stylesheet">
	<link href="/assets/vendor/fontawesome/css/brands.min.css" rel="stylesheet">
	<link href="/assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
	<link href="/assets/css/master.css" rel="stylesheet">
	<link href="/assets/vendor/flagiconcss/css/flag-icon.min.css" rel="stylesheet">
	<style>
		/* Sidebar Temel Stiller */
		.sidebar-header { background: linear-gradient(135deg, #1F2937 0%, #374151 100%); padding: 1rem !important; }
		.app-logo { height: 38px; width: auto; }
		#sidebar { background: #1F2937; overflow-y: auto; }

		/* Menü Bölüm Başlığı */
		.menu-section {
			font-size: 0.7rem;
			text-transform: uppercase;
			letter-spacing: 1px;
			color: #9CA3AF;
			padding: 1.2rem 1.5rem 0.5rem;
			margin-top: 0.5rem;
			font-weight: 600;
		}

		/* Menü Öğeleri - Temel Stil */
		#sidebar ul li a {
			color: #D1D5DB;
			transition: all 0.25s ease;
			border-left: 3px solid transparent;
			padding: 0.75rem 1.5rem;
			display: flex;
			align-items: center;
		}

		/* Menü Öğeleri - Hover Durumu */
		#sidebar ul li a:hover {
			background: rgba(139, 92, 246, 0.15);
			color: #FFFFFF;
			border-left-color: #8B5CF6;
			transform: translateX(2px);
		}

		/* Menü Öğeleri - Aktif Sayfa */
		#sidebar ul li a.active {
			background: rgba(139, 92, 246, 0.25);
			color: #FFFFFF;
			border-left-color: #8B5CF6;
			font-weight: 600;
		}

		/* Menü İkonları */
		#sidebar ul li a .fas {
			color: #8B5CF6;
			margin-right: 10px;
			width: 20px;
			text-align: center;
		}

		/* Modul Grubu Başlık */
		.module-header {
			display: flex;
			align-items: center;
			justify-content: space-between;
			padding: 0.85rem 1.5rem;
			color: #D1D5DB;
			cursor: pointer;
			transition: all 0.25s ease;
			border-left: 3px solid transparent;
		}

		.module-header:hover {
			background: rgba(139, 92, 246, 0.15);
			color: #FFFFFF;
			border-left-color: #8B5CF6;
		}

		.module-header .module-icon {
			color: #8B5CF6;
			margin-right: 10px;
			font-size: 1rem;
		}

		.module-header .module-title {
			font-weight: 600;
			font-size: 0.9rem;
		}

		.module-header .collapse-icon {
			color: #9CA3AF;
			transition: transform 0.3s ease;
			font-size: 0.75rem;
		}

		.module-header[aria-expanded="true"] {
			background: rgba(139, 92, 246, 0.1);
			border-left-color: #8B5CF6;
		}

		.module-header[aria-expanded="true"] .collapse-icon {
			transform: rotate(180deg);
			color: #8B5CF6;
		}

		/* Alt Menü */
		.module-submenu {
			background: rgba(0, 0, 0, 0.1);
			border-left: 1px solid rgba(139, 92, 246, 0.2);
			margin-left: 1.5rem;
		}

		.module-submenu li a {
			padding: 0.65rem 1rem 0.65rem 2rem !important;
			font-size: 0.85rem;
			color: #D1D5DB;
		}

		.module-submenu li a:hover {
			background: rgba(139, 92, 246, 0.2);
			padding-left: 2.25rem !important;
		}

		.module-submenu li a.active {
			background: rgba(139, 92, 246, 0.3);
			font-weight: 600;
		}

		/* Badge Stilleri */
		.menu-badge {
			background: #EF4444;
			color: #FFFFFF;
			font-size: 0.7rem;
			padding: 2px 6px;
			border-radius: 10px;
			margin-left: auto;
			font-weight: 600;
			min-width: 20px;
			text-align: center;
		}

		.menu-badge.success { background: #10B981; }
		.menu-badge.warning { background: #F59E0B; }
		.menu-badge.info { background: #3B82F6; }

		/* Toast Bildirimleri */
		#toast-container { position: fixed; top: 20px; right: 20px; z-index: 9999; }
		.toast-message { padding: 15px 25px; margin-bottom: 10px; border-radius: 8px; color: #fff; font-weight: 500; box-shadow: 0 4px 12px rgba(0,0,0,0.15); animation: slideIn 0.3s ease; }
		.toast-message.error { background: linear-gradient(135deg, #ef4444, #dc2626); }
		.toast-message.success { background: linear-gradient(135deg, #22c55e, #16a34a); }
		.toast-message.warning { background: linear-gradient(135deg, #f59e0b, #d97706); }
		.toast-message.info { background: linear-gradient(135deg, #3b82f6, #2563eb); }
		@@keyframes slideIn { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
	</style>
</head>
<body>
	<!-- Toast Container -->
	<div id="toast-container"></div>

	<div class="wrapper">
        <nav id="sidebar">
            <div class="sidebar-header">
                <img src="/assets/img/masker-bo-logo.svg" alt="MASKER BO" class="app-logo">
            </div>
@await Component.InvokeAsync("DinamikMenu")
        </nav>
        <div id="body" class="active">
            <!-- navbar navigation component -->
            <nav class="navbar navbar-expand-lg navbar-white bg-white">
                <button type="button" id="sidebarCollapse" class="btn btn-light">
                    <i class="fas fa-bars"></i><span></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav ms-auto">
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                <i class="fas fa-user-circle"></i> Yönetim
                            </a>
                            <div class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
                                @if (User.IsInRole("Admin"))
                                {
                                    <a class="dropdown-item" href="/Kullanici">
                                        <i class="fas fa-users-cog"></i> Kullanıcı Yönetimi
                                    </a>
                                    <a class="dropdown-item" href="/MenuYonetim">
                                        <i class="fas fa-bars"></i> Menü Yönetimi
                                    </a>
                                    <div class="dropdown-divider"></div>
                                }
                                <a class="dropdown-item" href="/Account/Profil">
                                    <i class="fas fa-user-circle"></i> Profilim
                                </a>
                                <div class="dropdown-divider"></div>
                                <a class="dropdown-item" href="/Account/CikisYap">
                                    <i class="fas fa-sign-out-alt"></i> Çıkış Yap
                                </a>
                            </div>
                        </li>
                    </ul>
                </div>
            </nav>
            <div class="content">
                @RenderBody()
            </div>
            <!-- end of navbar navigation -->
         </div>
    </div>
    <script src="/assets/vendor/jquery/jquery.min.js"></script>
    <script src="/assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="/assets/vendor/chartsjs/Chart.min.js"></script>
    <script src="/assets/js/dashboard-charts.js"></script>
    <script src="/assets/js/script.js"></script>
    <script src="/assets/vendor/datatables/datatables.min.js"></script>
    <script src="/assets/js/initiate-datatables.js"></script>

    <!-- Toast Bildirimi Scripti -->
    <script>
        function showToast(message, type = 'info') {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            toast.className = 'toast-message ' + type;
            toast.innerHTML = '<i class="fas fa-' + (type === 'error' ? 'exclamation-circle' : type === 'success' ? 'check-circle' : 'info-circle') + '"></i> ' + message;
            container.appendChild(toast);
            setTimeout(() => { toast.style.animation = 'slideIn 0.3s ease reverse'; setTimeout(() => toast.remove(), 300); }, 4000);
        }

        @if (TempData["Error"] != null)
        {
            <text>showToast('@TempData["Error"]', 'error');</text>
        }
        @if (TempData["Success"] != null)
        {
            <text>showToast('@TempData["Success"]', 'success');</text>
        }
        @if (TempData["Warning"] != null)
        {
            <text>showToast('@TempData["Warning"]', 'warning');</text>
        }
    </script>

    <!-- Menü İyileştirmeleri Scripti -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Aktif sayfa algılama ve vurgulama
            const currentPath = window.location.pathname;
            const menuLinks = document.querySelectorAll('#sidebar ul li a:not(.module-header)');

            menuLinks.forEach(link => {
                const href = link.getAttribute('href');
                if (href && currentPath.startsWith(href) && href !== '/') {
                    link.classList.add('active');

                    // Eğer alt menü öğesiyse, parent menüyü aç
                    const parentCollapse = link.closest('.collapse');
                    if (parentCollapse) {
                        parentCollapse.classList.add('show');
                        const parentHeader = document.querySelector(`[data-bs-target="#${parentCollapse.id}"]`);
                        if (parentHeader) {
                            parentHeader.setAttribute('aria-expanded', 'true');
                        }
                    }
                } else if (href === '/' && currentPath === '/') {
                    link.classList.add('active');
                }
            });

            // Accordion davranışı - Sadece bir menü açık olsun
            const moduleHeaders = document.querySelectorAll('.module-header');
            moduleHeaders.forEach(header => {
                header.addEventListener('click', function() {
                    const isExpanded = this.getAttribute('aria-expanded') === 'true';

                    // Eğer menü kapalıysa ve başka menüler açıksa, onları kapat
                    if (!isExpanded) {
                        moduleHeaders.forEach(otherHeader => {
                            if (otherHeader !== this && otherHeader.getAttribute('aria-expanded') === 'true') {
                                const targetId = otherHeader.getAttribute('data-bs-target');
                                const collapseElement = document.querySelector(targetId);
                                if (collapseElement) {
                                    const bsCollapse = bootstrap.Collapse.getInstance(collapseElement);
                                    if (bsCollapse) {
                                        bsCollapse.hide();
                                    }
                                }
                            }
                        });
                    }
                });
            });

            // Smooth scroll için menü öğelerine tıklama efekti
            menuLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    // Aktif class'ı kaldır
                    menuLinks.forEach(l => l.classList.remove('active'));
                    // Tıklanan öğeye ekle
                    this.classList.add('active');
                });
            });
        });
    </script>
</body>
</html>
